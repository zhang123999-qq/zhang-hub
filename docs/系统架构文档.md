# ðŸ—ï¸ ç³»ç»Ÿæž¶æž„æ–‡æ¡£

## ä¸€ã€æ€»ä½“æž¶æž„æ¦‚è§ˆ
1. **æž¶æž„é£Žæ ¼**: å•ä½“æž¶æž„ï¼Œé‡‡ç”¨ Django + Vue3 å‰åŽç«¯åˆ†ç¦»æ¨¡å¼ã€‚é€‰æ‹©ç†ç”±ï¼šé¡¹ç›®è§„æ¨¡é€‚ä¸­ï¼Œå•ä½“æž¶æž„å¼€å‘å’Œéƒ¨ç½²æ›´ç®€å•ï¼Œç»´æŠ¤æˆæœ¬ä½Žï¼ŒåŒæ—¶å‰åŽç«¯åˆ†ç¦»ä¿è¯äº†å¼€å‘æ•ˆçŽ‡å’Œç”¨æˆ·ä½“éªŒã€‚

2. **æŠ€æœ¯æ ˆåˆ†å±‚**:
   - å±•ç¤ºå±‚ (Presentation Layer): Vue 3 + TypeScript + Element Plus
   - ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer): Django è§†å›¾å’ŒæœåŠ¡
   - æ•°æ®è®¿é—®å±‚ (Data Access Layer): Django ORM
   - åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer): Redisã€MySQLã€Celery

3. **éƒ¨ç½²æž¶æž„**: ç”Ÿäº§çŽ¯å¢ƒé‡‡ç”¨ Nginx åå‘ä»£ç†ï¼ŒDjango åº”ç”¨æœåŠ¡å™¨é›†ç¾¤ï¼ŒMySQL ä¸»ä»Žå¤åˆ¶ï¼ŒRedis ç¼“å­˜å’Œæ¶ˆæ¯é˜Ÿåˆ—ã€‚

## äºŒã€æŠ€æœ¯æ ˆè¯¦ç»†è¯´æ˜Ž

### 2.1 å‰ç«¯æŠ€æœ¯æ ˆ
```
Vue 3 + TypeScript + Composition API
â”œâ”€â”€ æ ¸å¿ƒæ¡†æž¶: Vue 3.3.4
â”œâ”€â”€ è·¯ç”±ç®¡ç†: Vue Router 4
â”œâ”€â”€ çŠ¶æ€ç®¡ç†: Pinia 2
â”œâ”€â”€ UIæ¡†æž¶: Element Plus
â”œâ”€â”€ æž„å»ºå·¥å…·: Vite 4
â”œâ”€â”€ ä»£ç è§„èŒƒ: ESLint + Prettier
â””â”€â”€ æµ‹è¯•æ¡†æž¶: Vitest + Playwright
```

### 2.2 åŽç«¯æŠ€æœ¯æ ˆ
```
Django 4.2 + Django REST Framework
â”œâ”€â”€ Webæ¡†æž¶: Django 4.2
â”œâ”€â”€ REST API: Django REST Framework 3.14
â”œâ”€â”€ æ•°æ®åº“: MySQL 8.0 + SQLite (å¼€å‘)
â”œâ”€â”€ ç¼“å­˜: Redis 7
â”œâ”€â”€ æ¶ˆæ¯é˜Ÿåˆ—: Celery + Redis
â”œâ”€â”€ è®¤è¯æŽˆæƒ: JWT + Djangoå†…ç½®è®¤è¯
â””â”€â”€ å®‰å…¨é˜²æŠ¤: CSRF, CORS, XSSé˜²æŠ¤ç­‰
```

## ä¸‰ã€ç³»ç»Ÿæ¨¡å—åˆ’åˆ†

### 3.1 æ ¸å¿ƒä¸šåŠ¡æ¨¡å—
1. **ç”¨æˆ·ç®¡ç†æ¨¡å—**
   - ç”¨æˆ·æ³¨å†Œ/ç™»å½•/è®¤è¯
   - æƒé™ç®¡ç†ç³»ç»Ÿ (RBAC)
   - ä¸ªäººèµ„æ–™ç®¡ç†

2. **åšå®¢ç³»ç»Ÿæ¨¡å—**
   - æ–‡ç« ç®¡ç† (CRUD)
   - åˆ†ç±»æ ‡ç­¾ç³»ç»Ÿ
   - è¯„è®ºäº’åŠ¨ç³»ç»Ÿ

3. **è®ºå›ç³»ç»Ÿæ¨¡å—**
   - å¸–å­ç®¡ç†
   - å›žå¸–ç³»ç»Ÿ
   - åˆ†åŒºç®¡ç†

4. **èµ„æºç®¡ç†æ¨¡å—**
   - èµ„æºä¸Šä¼ /ä¸‹è½½
   - èµ„æºåˆ†ç±»
   - èµ„æºå®¡æ ¸

### 3.2 æ”¯æ’‘æ¨¡å—
1. **æ–‡ä»¶ç®¡ç†æ¨¡å—**: å›¾ç‰‡/æ–‡ä»¶ä¸Šä¼ å¤„ç†
2. **æœç´¢æ¨¡å—**: å…¨æ–‡æœç´¢åŠŸèƒ½
3. **é€šçŸ¥æ¨¡å—**: ç«™å†…ä¿¡å’Œé‚®ä»¶é€šçŸ¥
4. **ç»Ÿè®¡æ¨¡å—**: è®¿é—®ç»Ÿè®¡å’Œæ•°æ®åˆ†æž

## å››ã€æ•°æ®æµè®¾è®¡

### 4.1 ç”¨æˆ·è¯·æ±‚å¤„ç†æµç¨‹
```
ç”¨æˆ·è¯·æ±‚ â†’ Nginx â†’ Djangoä¸­é—´ä»¶ â†’ è·¯ç”±åˆ†å‘ â†’ è§†å›¾å¤„ç† â†’ 
åºåˆ—åŒ–å™¨ â†’ æ¨¡åž‹æ“ä½œ â†’ æ•°æ®åº“ â†’ å“åº”è¿”å›ž
```

### 4.2 å¼‚æ­¥ä»»åŠ¡å¤„ç†æµç¨‹
```
è§¦å‘å¼‚æ­¥ä»»åŠ¡ â†’ Celeryä»»åŠ¡é˜Ÿåˆ— â†’ Workerå¤„ç† â†’ 
Rediså­˜å‚¨ç»“æžœ â†’ å‰ç«¯è½®è¯¢èŽ·å–ç»“æžœ
```

## äº”ã€æ•°æ®åº“è®¾è®¡

### 5.1 æ ¸å¿ƒè¡¨ç»“æž„
1. **ç”¨æˆ·è¡¨ (users_user)**
2. **æ–‡ç« è¡¨ (blog_article)**
3. **å¸–å­è¡¨ (forum_thread)**
4. **èµ„æºè¡¨ (resources_resource)**

### 5.2 æ•°æ®å…³ç³»å›¾
ä½¿ç”¨Mermaidè¯­æ³•æè¿°å®žä½“å…³ç³»

## å…­ã€APIæž¶æž„

### 6.1 RESTful APIè®¾è®¡åŽŸåˆ™
- èµ„æºå‘½åè§„èŒƒ
- HTTPæ–¹æ³•ä½¿ç”¨è§„èŒƒ
- çŠ¶æ€ç ä½¿ç”¨è§„èŒƒ
- ç‰ˆæœ¬æŽ§åˆ¶ç­–ç•¥

### 6.2 è®¤è¯æŽˆæƒæž¶æž„
- JWTä»¤ç‰Œè®¤è¯æµç¨‹
- æƒé™æ ¡éªŒæœºåˆ¶
- è®¿é—®æŽ§åˆ¶åˆ—è¡¨ (ACL)

## ä¸ƒã€å®‰å…¨æž¶æž„

### 7.1 ç½‘ç»œå®‰å…¨
- HTTPSå¼ºåˆ¶ä½¿ç”¨
- CSPç­–ç•¥é…ç½®
- é˜²ç«å¢™è§„åˆ™

### 7.2 åº”ç”¨å®‰å…¨
- è¾“å…¥éªŒè¯å’Œè¿‡æ»¤
- SQLæ³¨å…¥é˜²æŠ¤
- XSS/CSRFé˜²æŠ¤
- æ–‡ä»¶ä¸Šä¼ å®‰å…¨

### 7.3 æ•°æ®å®‰å…¨
- æ•æ„Ÿæ•°æ®åŠ å¯†
- å¯†ç å“ˆå¸Œå­˜å‚¨
- æ•°æ®å¤‡ä»½ç­–ç•¥

## å…«ã€æ€§èƒ½ä¼˜åŒ–æž¶æž„

### 8.1 å‰ç«¯ä¼˜åŒ–
- ä»£ç åˆ†å‰²å’Œæ‡’åŠ è½½
- å›¾ç‰‡ä¼˜åŒ–ç­–ç•¥
- ç¼“å­˜ç­–ç•¥

### 8.2 åŽç«¯ä¼˜åŒ–
- æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- Redisç¼“å­˜ç­–ç•¥
- è¿žæŽ¥æ± é…ç½®

### 8.3 CDNå’Œé™æ€èµ„æº
- é™æ€èµ„æºCDNåˆ†å‘
- æµè§ˆå™¨ç¼“å­˜ç­–ç•¥

## ä¹ã€ç›‘æŽ§å’Œæ—¥å¿—

### 9.1 ç›‘æŽ§ç³»ç»Ÿ
- åº”ç”¨æ€§èƒ½ç›‘æŽ§
- é”™è¯¯è¿½è¸ª (Sentry)
- ä¸šåŠ¡æŒ‡æ ‡ç›‘æŽ§

### 9.2 æ—¥å¿—ç³»ç»Ÿ
- è®¿é—®æ—¥å¿—
- é”™è¯¯æ—¥å¿—
- ä¸šåŠ¡æ—¥å¿—
- å®¡è®¡æ—¥å¿—

## åã€éƒ¨ç½²æž¶æž„

### 10.1 å¼€å‘çŽ¯å¢ƒ
- Docker Composeæœ¬åœ°å¼€å‘
- çƒ­é‡è½½é…ç½®

### 10.2 ç”Ÿäº§çŽ¯å¢ƒ
- å¤šèŠ‚ç‚¹éƒ¨ç½²
- è´Ÿè½½å‡è¡¡é…ç½®
- æ•°æ®åº“ä¸»ä»Žå¤åˆ¶
- é«˜å¯ç”¨è®¾è®¡

## åä¸€ã€æ‰©å±•æ€§è®¾è®¡

### 11.1 æ°´å¹³æ‰©å±•
- æ— çŠ¶æ€æœåŠ¡è®¾è®¡
- ä¼šè¯å…±äº«æ–¹æ¡ˆ

### 11.2 åž‚ç›´æ‰©å±•
- æ•°æ®åº“åˆ†åº“åˆ†è¡¨æ–¹æ¡ˆ
- è¯»å†™åˆ†ç¦»è®¾è®¡

## åäºŒã€å®¹ç¾å’Œå¤‡ä»½

### 12.1 å®¹ç¾æ–¹æ¡ˆ
- å¤šå¯ç”¨åŒºéƒ¨ç½²
- æ•…éšœè½¬ç§»ç­–ç•¥

### 12.2 å¤‡ä»½ç­–ç•¥
- æ•°æ®åº“å¤‡ä»½
- æ–‡ä»¶å¤‡ä»½
- é…ç½®å¤‡ä»½

## åä¸‰ã€æŠ€æœ¯å†³ç­–è®°å½• (ADR)
è®°å½•é‡è¦çš„æŠ€æœ¯å†³ç­–å’Œç†ç”±

## åå››ã€æž¶æž„å›¾

### 1. æ•´ä½“æž¶æž„å›¾
```mermaid
graph TB
    subgraph "ç”¨æˆ·å±‚"
        U1[Webç”¨æˆ·]
        U2[ç§»åŠ¨ç”¨æˆ·]
        U3[APIè°ƒç”¨è€…]
    end
    
    subgraph "æŽ¥å…¥å±‚"
        N1[Nginxè´Ÿè½½å‡è¡¡]
        N2[CDNåŠ é€Ÿ]
    end
    
    subgraph "åº”ç”¨å±‚"
        subgraph "å‰ç«¯æœåŠ¡"
            F1[Vueåº”ç”¨æœåŠ¡å™¨]
            F2[é™æ€èµ„æºæœåŠ¡å™¨]
        end
        
        subgraph "åŽç«¯æœåŠ¡"
            B1[Djangoåº”ç”¨æœåŠ¡å™¨1]
            B2[Djangoåº”ç”¨æœåŠ¡å™¨2]
            B3[Celery Worker]
            B4[Celery Beat]
        end
    end
    
    subgraph "æ•°æ®å±‚"
        DB1[(MySQLä¸»åº“)]
        DB2[(MySQLä»Žåº“)]
        R1[(Redisç¼“å­˜)]
        R2[(Redisæ¶ˆæ¯é˜Ÿåˆ—)]
        ES[(Elasticsearch)]
    end
    
    subgraph "ç›‘æŽ§å±‚"
        M1[Prometheus]
        M2[Grafana]
        M3[Sentry]
    end
    
    U1 --> N1
    U2 --> N1
    U3 --> N1
    
    N1 --> F1
    N1 --> B1
    N1 --> B2
    
    F1 --> B1
    F1 --> B2
    
    B1 --> DB1
    B2 --> DB1
    B3 --> DB1
    
    DB1 --> DB2
    
    B1 --> R1
    B2 --> R1
    B3 --> R2
    
    B1 --> ES
    B2 --> ES
    
    B1 --> M1
    B2 --> M1
    F1 --> M1
    
    M1 --> M2
    B1 --> M3
    B2 --> M3
```

### 2. æ•°æ®æµå›¾
```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant Browser as æµè§ˆå™¨
    participant Nginx as Nginxä»£ç†
    participant Django as Djangoåº”ç”¨
    participant DB as æ•°æ®åº“
    participant Cache as Redisç¼“å­˜
    participant Queue as æ¶ˆæ¯é˜Ÿåˆ—
    
    User->>Browser: è®¿é—®ç½‘ç«™
    Browser->>Nginx: HTTPè¯·æ±‚
    Nginx->>Django: è½¬å‘è¯·æ±‚
    
    alt é™æ€èµ„æºè¯·æ±‚
        Django-->>Browser: è¿”å›žé™æ€æ–‡ä»¶
    else APIè¯·æ±‚
        Django->>Cache: æ£€æŸ¥ç¼“å­˜
        alt ç¼“å­˜å‘½ä¸­
            Cache-->>Django: è¿”å›žç¼“å­˜æ•°æ®
        else ç¼“å­˜æœªå‘½ä¸­
            Django->>DB: æŸ¥è¯¢æ•°æ®åº“
            DB-->>Django: è¿”å›žæ•°æ®
            Django->>Cache: ç¼“å­˜ç»“æžœ
        end
        
        Django-->>Nginx: JSONå“åº”
        Nginx-->>Browser: è¿”å›žå“åº”
        Browser-->>User: æ¸²æŸ“é¡µé¢
        
        alt éœ€è¦å¼‚æ­¥å¤„ç†
            Django->>Queue: å‘é€å¼‚æ­¥ä»»åŠ¡
            Queue->>Django: Workerå¤„ç†ä»»åŠ¡
            Django->>DB: æ›´æ–°æ•°æ®
        end
    end
```

### 3. å®‰å…¨æž¶æž„å›¾
```mermaid
graph LR
    subgraph "ç½‘ç»œå®‰å…¨"
        FW[é˜²ç«å¢™]
        WAF[WAFé˜²æŠ¤]
        DDoS[DDoSé˜²æŠ¤]
    end
    
    subgraph "ä¼ è¾“å®‰å…¨"
        SSL[SSL/TLSåŠ å¯†]
        HSTS[HSTSå¼ºåˆ¶HTTPS]
        CSP[å†…å®¹å®‰å…¨ç­–ç•¥]
    end
    
    subgraph "åº”ç”¨å®‰å…¨"
        Auth[è®¤è¯ç³»ç»Ÿ]
        Authz[æŽˆæƒç³»ç»Ÿ]
        Valid[è¾“å…¥éªŒè¯]
        XSS[XSSé˜²æŠ¤]
        CSRF[CSRFé˜²æŠ¤]
        SQLi[SQLæ³¨å…¥é˜²æŠ¤]
    end
    
    subgraph "æ•°æ®å®‰å…¨"
        Encrypt[æ•°æ®åŠ å¯†]
        Hash[å¯†ç å“ˆå¸Œ]
        Backup[æ•°æ®å¤‡ä»½]
        Audit[å®¡è®¡æ—¥å¿—]
    end
    
    Internet --> FW --> WAF --> DDoS --> SSL --> HSTS
    
    HSTS --> Auth
    HSTS --> Authz
    
    Auth --> Valid --> XSS --> CSRF --> SQLi
    
    SQLi --> Encrypt --> Hash --> Backup --> Audit
    
    CSP --> Valid
```

### 4. éƒ¨ç½²æž¶æž„å›¾
```mermaid
graph TB
    subgraph "è´Ÿè½½å‡è¡¡å±‚"
        LB1[è´Ÿè½½å‡è¡¡å™¨ ä¸»]
        LB2[è´Ÿè½½å‡è¡¡å™¨ å¤‡]
    end
    
    subgraph "WebæœåŠ¡å™¨å±‚"
        Web1[Nginx 1]
        Web2[Nginx 2]
        Web3[Nginx 3]
    end
    
    subgraph "åº”ç”¨æœåŠ¡å™¨å±‚"
        App1[App Server 1]
        App2[App Server 2]
        App3[App Server 3]
        Worker1[Celery Worker 1]
        Worker2[Celery Worker 2]
    end
    
    subgraph "æ•°æ®å­˜å‚¨å±‚"
        DB_Master[(MySQL Master)]
        DB_Slave1[(MySQL Slave 1)]
        DB_Slave2[(MySQL Slave 2)]
        Cache_Master[(Redis Master)]
        Cache_Slave[(Redis Slave)]
        ES1[(Elasticsearch 1)]
        ES2[(Elasticsearch 2)]
    end
    
    subgraph "å¯¹è±¡å­˜å‚¨"
        OSS[å¯¹è±¡å­˜å‚¨æœåŠ¡]
    end
    
    subgraph "ç›‘æŽ§å±‚"
        Monitor[ç›‘æŽ§æœåŠ¡å™¨]
        Alert[å‘Šè­¦ç³»ç»Ÿ]
        Log[æ—¥å¿—æ”¶é›†]
    end
    
    Internet --> LB1
    Internet --> LB2
    
    LB1 --> Web1
    LB1 --> Web2
    LB1 --> Web3
    LB2 --> Web1
    LB2 --> Web2
    LB2 --> Web3
    
    Web1 --> App1
    Web1 --> App2
    Web2 --> App1
    Web2 --> App3
    Web3 --> App2
    Web3 --> App3
    
    App1 --> DB_Master
    App2 --> DB_Master
    App3 --> DB_Master
    
    DB_Master --> DB_Slave1
    DB_Master --> DB_Slave2
    
    App1 --> Cache_Master
    App2 --> Cache_Master
    App3 --> Cache_Master
    Cache_Master --> Cache_Slave
    
    App1 --> ES1
    App2 --> ES2
    App3 --> ES1
    
    App1 --> OSS
    App2 --> OSS
    App3 --> OSS
    
    App1 --> Monitor
    App2 --> Monitor
    App3 --> Monitor
    Web1 --> Monitor
    Web2 --> Monitor
    Web3 --> Monitor
    
    Monitor --> Alert
    Monitor --> Log
```

### 5. å¾®æœåŠ¡æž¶æž„å›¾ï¼ˆå¯æ‰©å±•ï¼‰
```mermaid
graph TB
    subgraph "API Gateway"
        GW[APIç½‘å…³]
        AuthS[è®¤è¯æœåŠ¡]
        RateLimit[é™æµæœåŠ¡]
        Logging[æ—¥å¿—æœåŠ¡]
    end
    
    subgraph "ä¸šåŠ¡å¾®æœåŠ¡"
        UserS[ç”¨æˆ·æœåŠ¡]
        BlogS[åšå®¢æœåŠ¡]
        ForumS[è®ºå›æœåŠ¡]
        ResourceS[èµ„æºæœåŠ¡]
        SearchS[æœç´¢æœåŠ¡]
        NotificationS[é€šçŸ¥æœåŠ¡]
    end
    
    subgraph "æ”¯æ’‘æœåŠ¡"
        ConfigS[é…ç½®ä¸­å¿ƒ]
        Registry[æœåŠ¡æ³¨å†Œä¸­å¿ƒ]
        MonitorS[ç›‘æŽ§æœåŠ¡]
        Tracing[é“¾è·¯è¿½è¸ª]
    end
    
    subgraph "æ•°æ®æœåŠ¡"
        DBCache[æ•°æ®åº“ç¼“å­˜]
        MessageQ[æ¶ˆæ¯é˜Ÿåˆ—]
        ObjectS[å¯¹è±¡å­˜å‚¨]
        DBS[(å…±äº«æ•°æ®åº“)]
    end
    
    Client --> GW
    GW --> AuthS
    GW --> RateLimit
    GW --> Logging
    
    GW --> UserS
    GW --> BlogS
    GW --> ForumS
    GW --> ResourceS
    GW --> SearchS
    GW --> NotificationS
    
    UserS --> DBS
    BlogS --> DBS
    ForumS --> DBS
    ResourceS --> DBS
    
    UserS --> DBCache
    BlogS --> DBCache
    ForumS --> DBCache
    
    BlogS --> MessageQ
    NotificationS --> MessageQ
    
    ResourceS --> ObjectS
    
    UserS --> ConfigS
    BlogS --> ConfigS
    ForumS --> ConfigS
    
    UserS --> Registry
    BlogS --> Registry
    ForumS --> Registry
    
    UserS --> MonitorS
    BlogS --> MonitorS
    ForumS --> MonitorS
    
    UserS --> Tracing
    BlogS --> Tracing
    ForumS --> Tracing
```